<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap.min.css">
  <script src="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
  <script src="/socket.io/socket.io.js"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
  <script src="/flipclock/js/flipclock.min.js"></script>
  <link rel="stylesheet" href="/flipclock/css/flipclock.css">

</head>
<body>
  <div class="container">
    <h1>Tube Predictor</h1>
  </div>
  <button type="button" id="getTime" class="btn btn-default">Get Tube Time</button>
  <button type="button" id="getPrediction" class="btn btn-default">Get Tube Prediction</button>
  <div class="container" id="timeValue">
  </div>
  <div class="tubeClock"></div>
  <script>
  var socket = io.connect('http://localhost:8080');
  var clock;

  $(function() {
    clock = $('.tubeClock').FlipClock(3600, {
      countdown: true,
      clockFace: 'MinuteCounter'
    });

  });

  socket.on('connect', function(){
    alert("Session started!");
  });

  $(function(){
    $('#getTime').click( function() {
      socket.emit('getTubeTime', "Moorgate");
    });
  });

  $(function(){
    $('#getPrediction').click( function() {
      socket.emit('getArrivalPrediction', "Moorgate");
    });
  });

  socket.on('newTubeTime', function(time) {
    document.getElementById('timeValue').innerHTML = '<h2>Train leaving in ' + time + ' seconds </h2>';
    alert('should be displaying clock!');
    clock.setTime(time);
    //clock.start();
  });

  socket.on('newArrivalPrediction', function(data) {
    console.log(data);
  });

  </script>
</body>
</html>
